<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>T·∫°o h√≥a ƒë∆°n nh√°p</title>
    <style>
        *{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif}
        body{margin:0;padding:12px;background:#f5f5f5;font-size:14px}
        h2{margin:0 0 12px;font-size:18px;color:#333}
        .row{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:8px}
        .row>div{flex:1 1 260px;display:flex;flex-direction:column}
        label{font-weight:bold;margin-bottom:4px}
        textarea,input[type=number],input[type=text]{width:100%;padding:8px;border:1px solid #bbb;border-radius:4px;resize:vertical;font-size:14px}
        textarea{min-height:40px;font-family:inherit}
        table{width:100%;border-collapse:collapse;background:#fff;margin-top:8px;font-size:14px}
        th,td{border:1px solid #ddd;padding:6px 4px;text-align:center;word-break:break-word}
        th{background:#eee}
        .btn-add{background:#28a745;color:#fff;border:none;padding:6px 10px;border-radius:4px;font-size:14px}
        .btn-send{background:#007bff;color:#fff;border:none;padding:8px 16px;border-radius:4px;font-size:14px;margin-top:8px;width:100%}
        .btn-del{background:#dc3545;color:#fff;border:none;padding:4px 6px;border-radius:4px;font-size:12px}
        @media(max-width:500px){table{font-size:12px}th,td{padding:4px 2px}}
    </style>
</head>
<body>

<h2>Y√äU C·∫¶U T·∫†O H√ìA ƒê∆†N NH√ÅP</h2>

<!-- T√™n c√¥ng ty & MST c√πng d√≤ng, textarea ƒëa d√≤ng -->
<div class="row">
    <div>
        <label>T√™n c√¥ng ty + MST</label>
        <textarea id="cty_mst" rows="2" placeholder="T√™n c√¥ng ty&#10;MST: 0123456789"></textarea>
    </div>
</div>

<table id="hangTable">
    <thead>
        <tr>
            <th style="width:45%">T√™n s·∫£n ph·∫©m</th>
            <th style="width:20%">S·ªë l∆∞·ª£ng</th>
            <th style="width:25%">ƒê∆°n gi√° (VNƒê)</th>
            <th style="width:10%"></th>
        </tr>
    </thead>
    <tbody></tbody>
</table>
<button class="btn-add" onclick="themHang()">+ Th√™m h√†ng</button>

<button class="btn-send" onclick="guiTelegram()">G·ª≠i ƒëi</button>

<script>
    const TOKEN = "5572397080:AAFqa1dOYqvKrQ8-Wx5ez7PaqsVtvWU8vjA";
    const CHAT_ID = "-4686229366";

    function formatNumber(num){return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}
    function parseNumber(str){return parseInt(str.replace(/,/g,""))||0}

    function themHang(){
        const tbody=document.querySelector('#hangTable tbody');
        const tr=document.createElement('tr');
        tr.innerHTML=`
            <td><textarea rows="2" placeholder="T√™n SP"></textarea></td>
            <td><input type="number" min="1" value="1"></td>
            <td><input type="text" placeholder="0" oninput="formatInput(this)"></td>
            <td><button class="btn-del" onclick="this.closest('tr').remove()">X√≥a</button></td>
        `;
        tbody.appendChild(tr);
    }
    function formatInput(el){
        let v=el.value.replace(/,/g,'');
        if(!isNaN(v)&&v!=='')el.value=formatNumber(v);
    }
    themHang();

    async function guiTelegram(){
        const cty_mst=document.getElementById('cty_mst').value.trim();
        if(!cty_mst){alert("Vui l√≤ng nh·∫≠p T√™n c√¥ng ty & MST!");return;}
        let msg=`üìÑ Y√äU C·∫¶U H√ìA ƒê∆†N NH√ÅP\n${cty_mst}\n\nChi ti·∫øt:\n`;

        const rows=document.querySelectorAll('#hangTable tbody tr');
        let ok=false;
        rows.forEach(r=>{
            const ten=r.cells[0].querySelector('textarea').value.trim();
            const sl=r.cells[1].querySelector('input').value;
            const dg=parseNumber(r.cells[2].querySelector('input').value);
            if(ten){msg+=`- ${ten} | SL:${sl} | ƒêG:${dg}ƒë\n`;ok=true;}
        });
        if(!ok){alert("Vui l√≤ng nh·∫≠p √≠t nh·∫•t 1 s·∫£n ph·∫©m!");return;}

        try{
            await fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`,{
                method:"POST",
                headers:{"Content-Type":"application/json"},
                body:JSON.stringify({chat_id:CHAT_ID,text:msg})
            });
            alert("G·ª≠i th√†nh c√¥ng!");
        }catch(e){alert("L·ªói g·ª≠i Telegram: "+e);}
    }
</script>

</body>
</html>
